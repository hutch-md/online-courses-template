---
title: Getting Launch Monitor Data into R
author: Michael Hutchinson
date: '2022-01-02'
slug: getting-launch-monitor-data-into-r
categories: []
tags: []
subtitle: ''
summary: ''
authors: [Michael D Hutchinson]
lastmod: '2022-01-02T16:00:40-08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
weight: 1

---



## What this tutorial covers

As an analyst or data scientist, one thing they don’t tell you in school is how much time you’ll spend accessing, scraping, extracting, wrangling, munging, cleaning, transforming, shaping, prepping, and a hundred other verbs that all essentially mean “get the data into a form that allows us to cleanly analyze, visualize, or model.” 

This kind of work tends to get abbreviated to three letters: **ETL** (or **ELT**), which stands for **E**xtract, **T**ransform, **L**oad, and it's exactly what we're going to do here.

This first tutorial will cover:

1. Exporting data from Foresight 
2. Installing R and R-Studio
3. Loading the data into R and prepping it for analysis

Let's get started!

***

## STEP 1: Get Data

I expect you'll eventually want to get your own data in here, but for the purposes of this tutorial I've provided an export of my data from a session on my GC3 comparing Driver and 3-Wood. If you don't plan on using your own data just yet, you can [**download the .csv  here**](https://www.dropbox.com/s/5w6kbrn97k9myk8/Foresight_Report_Numeric.csv?dl=0){target="_blank"} and skip ahead to [**step 2**](#install_r).

If you have your own Foresight Launch Monitor or have access to one via a golf pro, fitter, or even your local golf superstore, I'm going to show you how to export a custom report that will look identical to my own. This way you hopefully won't need to modify any of the code.

If you have a different kind of launch monitor (Trackman, Mevo+, etc...) and want to be able to analyze your data, feel free to email an export of your data to me at **michaeldavidhutchinson@gmail.com** and I can add some code to clean and work with it. Eventually I'd like to build a large database for different types of analysis, so if you have data, send it over.

Anyway, here's how to export data with Foresight....

1. From the Foresight range, **click on the icon that looks like a side view of ball flight data**.
```{r, echo=FALSE, out.width="100%", fig.cap="Foresight Range"}
knitr::include_graphics("https://res.cloudinary.com/hutch-md/image/upload/v1641170945/1._Foresight_Range_qb370v.png")
```

2. From this data view screen, click **EXPORT** in the top right corner.
```{r, echo=FALSE, out.width="100%", fig.cap="Data View"}
knitr::include_graphics("https://res.cloudinary.com/hutch-md/image/upload/v1641170934/2._Data_View_bojlna.png")
```

3. In the report manager view, you're going to **create a custom report**.
```{r, echo=FALSE, out.width="100%", fig.cap="Report Manager View"}
knitr::include_graphics("https://res.cloudinary.com/hutch-md/image/upload/c_scale,h_1080,w_1920/v1641170934/3._Report_Manager_View_m7e69m.png")
```
4. **Select all available fields for ball and club data**, regardless of whether your specific simulator captures the variable. This ensures consistency in the data across all reports so that the code runs as expected. It's also nice to have a report that just captures everything. Give the report a name and hit **Save/Add**.
```{r, echo=FALSE, out.width="100%", fig.cap="Custom Report"}
knitr::include_graphics("https://res.cloudinary.com/hutch-md/image/upload/c_scale,h_1080,w_1920/v1641170935/4._Custom_Report_Field_Selector_waizmi.png")
```

5. The name of your custom report will now appear in the list of the standard reports. Choose the report (the white report is the one that is currently selected). You can email or save it locally as a .csv. <br><br> I have exported both the "Human Friendly" and "Numeric" .csv versions, and they each need some work to get into a tidy dataset, but **the "Numeric" version is easier to work with**. <br><br>Save the exported file somewhere you'll be able to access it. We'll move it to its final location in a little bit.  
```{r, echo=FALSE, out.width="100%", fig.cap="Custom Report"}
knitr::include_graphics("https://res.cloudinary.com/hutch-md/image/upload/v1641170935/5._Report_Manager_Export_Screen_gmx691.png")
```
<br>
Okay! Save that file somewhere you'll remember because we're going to come back to it in a bit.  

***
<a id="install_r"></a>
  
## STEP 2: Install R
Assuming you don't already have it installed, there are tons of great tutorials out there about how to get up and running with R and R Studio, so I won't go into much detail here. **[This tutorial](https://www.datacamp.com/community/tutorials/installing-R-windows-mac-ubuntu){target="_blank"}** from Datacamp has everything you need to get started whether you're on Mac, Windows, or Ubuntu. If that doesn't work, a quick Google search will get you plenty of solid options.  

***

## STEP 3: Create New R Project

Now that we have R installed, let's start by opening R Studio and creating a new project by going to: `File -> New Project.`

You don't have to do these next steps exactly as I did, and the userflow may be slightly different depending on your OS and version, but it's good practice to create self contained new projects with organized directories, and as I'm learning, that's even more important if you want to build a website. Anyway, here's what that looks like...

<div class = "row">
<div class = "col-md-6">
<br><br>1. Create project in a new directory.
![](https://res.cloudinary.com/hutch-md/image/upload/v1641170935/B_-_1._New_Directory_tmbsqv.png)

</div>
  
<div class = "col-md-6">
<br><br>2. Select **New Project** as project type.
![](https://res.cloudinary.com/hutch-md/image/upload/v1641170936/B_-_2._New_Project_m3l39p.png)
</div>


<div class = "col-md-6">
<br><br> 3. Name your new directory
![](https://res.cloudinary.com/hutch-md/image/upload/v1641170936/B_-_3._Create_New_Directory_lnaqpf.png)
</div>
  
<div class = "col-md-6">
<br><br>4. Create new R Script...
![](https://res.cloudinary.com/hutch-md/image/upload/c_scale,h_757,w_1058/v1641186152/B_-_4._New_R_Script_jpojoa.png)
</div>
</div>

<center>
###  If you've made it this far, get pumped. We're about to get to the fun stuff.
</center>

<br>
```{r, echo=FALSE, out.width="100%", fig.align='center'}
knitr::include_graphics("https://media.giphy.com/media/QgkpTdk9UjsfpHqIVL/giphy.gif")
```

<br>
  
***
<br>


## STEP 4: Load the Data into R and Prep it for Analysis

Okay! We're ready to start scripting in R. 

<style>
div.blue { background-color:#FF9800; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

### A Note to Beginners
If you've never written any code before, that's totally fine! A lot of the following will be foreign to you, but you *should* be able to just copy/paste these code chunks into your R-script (the top left pane of your R-Studio screen) and run it line by line to produce the same results. If you get errors, try unblocking yourself by Googling the errors or looking for solutions on a site like [Stack Overflow](https://stackoverflow.com/). 

I also highly recommend taking an "Intro to R" course like  [this one offered by Data Camp](https://www.datacamp.com/courses/free-introduction-to-r).

</div><br>
Let's start by loading the packages that are going to help with the manipulation and visualization of our data. You can think of packages like libraries of specialized functions that help us do things we can't do with R as it comes out of the box.
<br>
You can install them by copy/pasting the following code into your R script (top-left pane), and running in the terminal (low-left pane) by clicking "Run" `(Mac: Cmd + Return, Windows: Ctrl + Enter)`.


```{r}
# Let's do this in two steps.
# First, create a vector of the packages we'll need for this tutorial
packages <- c('tidyverse', 'janitor', 'corrplot', 'ggthemes', 'DT')

```


```{r eval = FALSE}
# Now, pass the vector you just created into the pkgs 
# argument of the install.packages() function
install.packages(pkgs = packages)

```

```{r message = FALSE, warning = FALSE}
# We can load them one by one using the library function
library(tidyverse)
library(janitor)
library(corrplot)
library(ggthemes) 
library(DT)
```

```{r eval = FALSE, message = FALSE, warning = FALSE}
# Or we can do it the fancy way. Learning the `apply` set of 
# functions will save you a lot of time in R
lapply(X = packages, FUN = require, character.only = TRUE)
```

You may get some warning messages, and if you run into trouble, the only packages we **really** need for this tutorial are `tidyverse` and `janitor`, so get rid of headaches if necessary.

When we created a new project, we created a directory to store all files associated with the project. Let's go ahead and use the `getwd()` function to check where that working directory is on our machine. 

```{r eval = FALSE}
# Check our current working directory
getwd()
```

```{r echo = FALSE}
print('/Users/yourname/project_directory')
```

Yours will likely look different, but the important thing to realize is that this location is where R will look for any data you're looking to import. It's also where it will write anything we export.

Now, let's use the `dir.create()` function to create a subfolder where we'll store our Foresight report data.

```{r eval = FALSE}
# Create a new folder within our working directory called "Data"
dir.create("Data")
```
<style>
div.blue { background-color:##FF9800; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

### A Note on Functions
If you ever have questions about the specific functions and the arguments they take, you can add a question mark before the function name and run it in your console to get the documentation. For instance, running `?read_csv()` will tell us about that function.

</div><br>

**Take your launch monitor data file and save it into the folder you just created.** For your first run, I'd suggest just downloading the **[sample data](https://www.dropbox.com/s/5w6kbrn97k9myk8/Foresight_Report_Numeric.csv?dl=0)** I've provided so that if you run into trouble with running any of the following code, we can be sure it's not a problem with your export.

We're now going to read that dataset into R. Steps explained within the #commentary of the code. 


```{r message = FALSE}
# First, let's practice creating variables by making one for the 
# path from the working directory to the data we just stored
file_name <- "Data/Foresight_Report_Numeric.csv"

# Next, we'll make use of the read_csv() function to pull in our dataset. 
# You can see here that the read_csv() function is accepting the file_name
# object we just created.

# The first line of the Foresight report contains the name of the golfer
# and datetime of the launch monitor session.
report_details <- read_csv(file = file_name, col_names = FALSE, trim_ws = TRUE, n_max = 1)


```

Extract some metadata about the session that we'll use latter
```{r message = FALSE}
# Some regex to extract the username and get datetime values
# We'll add these as columns back into our dataset later
username <- str_extract(report_details$X1, "(?<=: ).*(?= -)")
datetime <- as.POSIXct(str_extract(report_details$X1, "(?<= - ).*"), format = '%m/%e/%Y %I:%M %p', tz=Sys.timezone())
```








